Предложения по платежам
=======================

Наиболее предпочтительным и перспективным вариантом платежей через Paypal на данный момент видится Paypal REST API.
Он поддерживает все современные форматы платежей и наибольшую гибкость.

Что необходимо для подключения.

1. Быть зарегистрированным на Paypal и зарегистрировать OAuth-приложение:
https://developer.paypal.com/developer/applications
Изначально там будут указаны параметры песочницы, так что с ними можно будет безопасно играться.

2. Документация по API находится тут: https://developer.paypal.com/docs/api/
  
3. Базовая информация о том как делать запросы: https://developer.paypal.com/docs/integration/direct/make-your-first-call/

4. Интересующий нас процесс формирования и исполнения платежа: https://developer.paypal.com/docs/integration/direct/create-process-order/

5. Paypal REST API SDK для PHP находится тут: https://github.com/paypal/PayPal-PHP-SDK
 

## Вариант использования с мобильным приложением.

Предлагаю такой вариант использования:

1. В п.4 выше указан процесс создания платежа. В нашем случае нам необходимо иметь свою сущность для платежа, которая связана с платежом Paypal.
    Для этого создаётся новая сущность Payment по аналогии с OAuthRequest, а также REST API контроллер для неё.
  
2. При необходимости оплаты мобильное приложение создаёт экземпляр платежа, который на сервере создаётся только если удаётся создать платёх в Paypal.
    Paypal возвращает информацию о созданном платеже, включая authorize_url, и вся эта информация возвращается в мобильное приложение.
    Мобильное приложение редиректит пользователя в браузер на authorize_url, и пользователь подтверждает оплату.
    После подтверждения мобильное приложение получает код PayerID в return_url: http://<return_url>?token=EC-60U79048BN7719609&PayerID=7E7MGXCWTTKK2.
        
3. Далее мобильное приложение исполняет платёж в REST API, который, в свою очередь, исполняет платёж Paypal.
    После этих действий оплата будет выполнена и монеты поступают на счёт пользователя.
  
  